import numpy as np
import pandas as pd
import pymysql as pm   
import mysql.connector as myconn
from threading import *
import os
import time

## Must have either pymysql or mysql.connection to establish connextion & should work well with python
#Make three folders and name these respectively - Processing, queue, processed

path1 = 'Assessment/Processing/'
path2 = 'Assessment/queue/'
path3 = 'Assessment/processed/'

def create(pa1):
    for i in range(10):#Set range according to file creation
        with open(os.path.join(pa1, f'myfile{i}.txt'), 'w') as fp:
            pass
    time.sleep(1)
    
    def move(pa1,pa2):
    for j in range(2):#Set range according to create fun
        time.sleep(5)
        all_files = os.listdir(pa1)
        for f1 in all_files:
            os.rename(pa1+f1,pa2+f1)
            
##Now establish connection with mysql and execute commands.

def update_move(pa2,pa3): #create database & name it Assessment
    conn = pm.connect(host='localhost',user='root',password='********',database='Assessment')
    cursor = conn.cursor()
    for k in range(2):#Set range according to create and move fun
        time.sleep(5)
        all_files = os.listdir(pa2)
        for f2 in all_files:
            cursor.execute('create table file_check(file_name varchar(255), present int)')
            cursor.execute('insert into file_check (file_name, present) values (f2,1)')
            conn.commit()
            os.rename(pa2+f2,pa3+f2)
            
## Using seperate thread for each function will ensure that all functions are running at same time.

t1=Thread(target=create, [args=(path1)])
t2=Thread(target=move, [args=(path1,path2)])
t3=Thread(target=update_move, [args=(path2,path3)])
t1.start()
t2.start()
t3.start()
